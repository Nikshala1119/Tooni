<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 650" style="background: #1a1a2e">
  <!-- Title -->
  <text x="450" y="40" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#ffffff">SVG Avatar Animation System</text>

  <!-- Character Container -->
  <rect x="50" y="70" width="350" height="520" rx="15" fill="#16213e" stroke="#4a5568" stroke-width="2"/>
  <text x="225" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#e2e8f0">Animated Character Parts</text>

  <!-- Simplified Character -->
  <g transform="translate(120, 120)">
    <!-- Head outline -->
    <ellipse cx="105" cy="80" rx="80" ry="70" fill="#f7c6a9" stroke="#333" stroke-width="2"/>

    <!-- Left Eye -->
    <ellipse cx="70" cy="70" rx="25" ry="20" fill="#fff" stroke="#333" stroke-width="2"/>
    <circle cx="70" cy="70" r="8" fill="#333"/>

    <!-- Right Eye -->
    <ellipse cx="140" cy="70" rx="25" ry="20" fill="#fff" stroke="#333" stroke-width="2"/>
    <circle cx="140" cy="70" r="8" fill="#333"/>

    <!-- Mouth (Open state) -->
    <ellipse cx="105" cy="120" rx="25" ry="15" fill="#4a1c1c" stroke="#2a1010" stroke-width="2"/>
    <ellipse cx="105" cy="128" rx="10" ry="5" fill="#e57373"/>

    <!-- Body -->
    <rect x="55" y="150" width="100" height="120" rx="10" fill="#f70032" stroke="#333" stroke-width="2"/>

    <!-- Glow Ring Indicator -->
    <circle cx="105" cy="200" r="130" fill="none" stroke="#22c55e" stroke-width="4" stroke-dasharray="20,10" opacity="0.7"/>
  </g>

  <!-- Annotation Lines and Labels -->

  <!-- Eyes annotation -->
  <line x1="310" y1="190" x2="380" y2="170" stroke="#60a5fa" stroke-width="2"/>
  <rect x="380" y="150" width="160" height="50" rx="5" fill="#1e3a5f" stroke="#60a5fa" stroke-width="1"/>
  <text x="460" y="172" text-anchor="middle" font-family="monospace" font-size="11" fill="#60a5fa">EYES (Blink)</text>
  <text x="460" y="188" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">opacity: 0 → 1</text>

  <!-- Mouth annotation -->
  <line x1="310" y1="240" x2="380" y2="260" stroke="#f472b6" stroke-width="2"/>
  <rect x="380" y="230" width="180" height="70" rx="5" fill="#1e3a5f" stroke="#f472b6" stroke-width="1"/>
  <text x="470" y="252" text-anchor="middle" font-family="monospace" font-size="11" fill="#f472b6">MOUTH (Lip-sync)</text>
  <text x="470" y="270" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">ry = 5 + (volume × 25)</text>
  <text x="470" y="288" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">range: 5px → 20px</text>

  <!-- Body bounce annotation -->
  <line x1="310" y1="350" x2="380" y2="380" stroke="#a78bfa" stroke-width="2"/>
  <rect x="380" y="350" width="180" height="70" rx="5" fill="#1e3a5f" stroke="#a78bfa" stroke-width="1"/>
  <text x="470" y="372" text-anchor="middle" font-family="monospace" font-size="11" fill="#a78bfa">BODY (Bounce)</text>
  <text x="470" y="390" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">translateY: 0 ↔ -3px</text>
  <text x="470" y="408" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">interval: 500ms</text>

  <!-- Glow ring annotation -->
  <line x1="310" y1="450" x2="380" y2="470" stroke="#22c55e" stroke-width="2"/>
  <rect x="380" y="440" width="180" height="90" rx="5" fill="#1e3a5f" stroke="#22c55e" stroke-width="1"/>
  <text x="470" y="462" text-anchor="middle" font-family="monospace" font-size="11" fill="#22c55e">STATUS GLOW</text>
  <text x="470" y="482" text-anchor="middle" font-family="monospace" font-size="10" fill="#22c55e">● Listening</text>
  <text x="470" y="500" text-anchor="middle" font-family="monospace" font-size="10" fill="#3b82f6">● Speaking</text>
  <text x="470" y="518" text-anchor="middle" font-family="monospace" font-size="10" fill="#f59e0b">● Muted</text>

  <!-- Data Flow Section -->
  <rect x="580" y="70" width="300" height="520" rx="15" fill="#16213e" stroke="#4a5568" stroke-width="2"/>
  <text x="730" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#e2e8f0">Animation Data Flow</text>

  <!-- Audio Input Box -->
  <rect x="610" y="130" width="240" height="60" rx="8" fill="#1e3a5f" stroke="#60a5fa" stroke-width="2"/>
  <text x="730" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#60a5fa">Audio Stream (24kHz)</text>
  <text x="730" y="175" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">ElevenLabs Voice Output</text>

  <!-- Arrow -->
  <path d="M730 190 L730 210" stroke="#4a5568" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Volume Analysis Box -->
  <rect x="610" y="220" width="240" height="80" rx="8" fill="#1e3a5f" stroke="#f472b6" stroke-width="2"/>
  <text x="730" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#f472b6">Volume Analysis</text>
  <text x="730" y="265" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">Web Audio API</text>
  <text x="730" y="285" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">amplitude → 0.0 to 1.0</text>

  <!-- Arrow -->
  <path d="M730 300 L730 320" stroke="#4a5568" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Mouth Calculation Box -->
  <rect x="610" y="330" width="240" height="80" rx="8" fill="#1e3a5f" stroke="#a78bfa" stroke-width="2"/>
  <text x="730" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#a78bfa">Mouth Height Calc</text>
  <text x="730" y="378" text-anchor="middle" font-family="monospace" font-size="11" fill="#fbbf24">mouthOpen = 5 + vol × 25</text>
  <text x="730" y="398" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">clamped: min(5) max(20)</text>

  <!-- Arrow -->
  <path d="M730 410 L730 430" stroke="#4a5568" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- SVG Update Box -->
  <rect x="610" y="440" width="240" height="80" rx="8" fill="#1e3a5f" stroke="#22c55e" stroke-width="2"/>
  <text x="730" y="465" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#22c55e">SVG Attribute Update</text>
  <text x="730" y="488" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">&lt;ellipse ry={mouthOpen}/&gt;</text>
  <text x="730" y="508" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">React re-render</text>

  <!-- Blink Timer Section -->
  <rect x="610" y="540" width="115" height="40" rx="5" fill="#1e3a5f" stroke="#60a5fa" stroke-width="1"/>
  <text x="668" y="558" text-anchor="middle" font-family="monospace" font-size="9" fill="#60a5fa">Blink Timer</text>
  <text x="668" y="572" text-anchor="middle" font-family="monospace" font-size="8" fill="#94a3b8">2.5-4.5s random</text>

  <!-- Bounce Timer Section -->
  <rect x="735" y="540" width="115" height="40" rx="5" fill="#1e3a5f" stroke="#a78bfa" stroke-width="1"/>
  <text x="793" y="558" text-anchor="middle" font-family="monospace" font-size="9" fill="#a78bfa">Bounce Timer</text>
  <text x="793" y="572" text-anchor="middle" font-family="monospace" font-size="8" fill="#94a3b8">500ms interval</text>

  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#4a5568"/>
    </marker>
  </defs>

  <!-- Legend -->
  <text x="450" y="620" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#64748b">Props: volume (0-1), isTalking (bool), isListening (bool), isConnected (bool), isMuted (bool)</text>
</svg>